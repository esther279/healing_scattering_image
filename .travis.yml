language: python
python:
  - 3.6
cache:
  directories:
    - $HOME/.cache/pip
    - $HOME/.ccache  # https://github.com/travis-ci/travis-ci/issues/5853

env:
  global:
    #Doctr deploy key for ligerliu/healing_scattering_image
    - secure: "gAAAAABba_BaoGtricTMsFs1Rb_cdaAHIYyDpKf4DU5pO5hJ40jOoxDzqhJEA9NSu9fiGtY7hcmw_ZGl_sgtY7dTpytlFpl7nVfrbVSAPEV6dPm6mDQSgn9OUomMkuw075VcH3SOEjBVn1nV58II49ZkDIH20VEWmnzIZhboNxhhBsXwT95_sMtmjPzhBkpiTf09AdpCa9-9iNYyYb9-xqNDhuaQXP-Ns1ItWRdEyhmpr7SJ01pcEsVyrU3zlcqSqibV1BvEF1CnGqpRYNJ6Dchr5YM6It6hniB9b9v7gZvNCECzjjG5K1tH3loKtJvc9tZdWygVyKMRGVSLnpTJOVB92niv09wvovP_DQqomVrR5MTXbWd0SYDkLaG-Dtuynw6_yQUa84r6FMpXvwsDCzFZd8-2jka2gCH4pndXVgBiWuOSp8Jdbsxq7Q84F64JWcolaQd93j0hOrTt1FGM4T-iyBexiRktmbbPap8J2xDszBKFMsEZVajKbuiMpFLidORKwT41fCwfZe3lV0kRamT6USRX0GMnEhIm0VJcy1yCnPCDXtjr5QmNW9K7PazmSHA7RzYM4yR8tI9JsQO0PW42-dnEVsGdCbmPwiidsSR7I93KUTqlA8_GeyUNAX7aFQnHEg_2-kpQn_3KMjBFTVTMvbdrFWYDlzopkYeafkgWKTLSmfZncUj8qgLGQyGIsUOz3JXmhOfjlrLwM18qP3SubMFq2E5InWfhuPBdZFRAZ0jOQpGvEN01Qq-kvrP8NoIdCHNR68BJa6BOAKYvSZaP_lV5TUT4ci0kDyAukvhjGI3PIeQQX-CH67qSMdXZ0tvmpjPKe6H9gcJhl6jMqWO22k6IwxTBN_qXWOTGXblgqYUTvP-nHllLewEXbEzTe6EIAKqGsXLennSBahdl-pn458ULLVPFaIYlbR6jnJXRVE6MixfHJMPeG8HewV2VV78dLTce_oblQV9BkhpOxyJg7E9ueLtu_NrsJce_u3b7jcLsVJBGzdRdvku7qHPy38M8iOCpYvF_o1biGm8zl1SeNLdN-C68aER6C2T4EhrcejlMRLkEA46PdoE-JSnEXFoCwX6h7P5DqCzSXgbpdJoHPf1Lg-JEoaB1nIMM0hDOqHWKQ59iqDXy3lQnjZEz4sn6F7RHgjNfD3ubNqVr4zUQRHcDbc0oQf2RdYf0bbJ5TyrOQzUEYcYkd1VZpSrSTDpBrxcP3nTZwoKfHTFxWPGen8tlMoDv_QxWSxN-x52TxzlKHJl6EQH40HTlVQOmPpN1JQDrzyKDtsTsE0-Dmbq2TMVm52UCAiEjeJWmWfSwcSVK5OM5elfEgInQjD4x-9cnsIs4rpEKiajM0a_mQ_8O1LWe90pk1u59ljs89wrUmAFtCRipOKzEWtcLJyW2oB0Axuw10miInH374axj0EF78IbT2EnPU0nXmnTncvc2VUefbWcdx7oayuP-T1ishyW61ZJxB_WhcahiEHHK2U5WuotSqEzBVJStp7466fOTgSOmVZFlOWBytnFC32Cdx7G0P1tjakpW34G9F6tPRg2DPyaYWgaKSWNnnKmYTSCoGNWnZ-1hOii5cZ8tEn42F3jqcUHmhJvHwcXfj1h_pMEgb7j7lbXltV7mRGH6W2PfsYG66Wig-I3i6iBILgSEQBLVfwwQUxRhD3nnqceKG-8CRJAIcMhZoBTOJtrVer5bTcETvMpm8LLHLDtDSPPW83iPhHJsoGqEJ9rF8MB542vFj9UhceV5RWSKrLEb2M_AohpN7DbqlZbVJmQSrmW74PGGXAaK28EfZlPNZdu8-7p4gQG7f3DYcOJuh0x0ys1TIAhQMKSoQpwIT2cbZqK5lxlxnuLwsqGHHc3-3Gtrip7VimOxEOHpEbo1K5REfFqXbt-aBsg4aWd_O9ZYZKm5FLkr98b6-dNtDuL3L6VyWYVJElZXDv1jQCujncs1zjKox3OYr96n7Mvdz2D0j8AA9kPvJvcoZPCw7qvpwXAllt-G8bS-lbaoTDuaF82rbScpI4SzIefJGLacKhy-KYO_qPp6EqfpJjoGF9AVo8ZhWuAhl2Z9wnLyqm6EoqojeaiFkzG8MoZY3uB7n3Wh2EGoGeXfLg3XNSVN08DvO_yLKHUM1llca83m_YIdtdPOuEJvRhT--nyj5A7Ay3vRj6gd-m1NTwYvLa6jgLuKZ_FORjryu1rgsarGVnoLWJ_1FOvU5r0_KF09cXKTm-g93UPUEqC1jOjwzhRDXoU7K9ZdaXmGLNqumfrGxiRWSDgUd_vKEsOJ9GFgaU89YMnhTaY1sQQdXBgphBdXeTLzRnp0uyStjDT9tVoixMQ_oGWtiokDqYNhRq0Fi6UA8naHKq8j_5b59ihCWJ2aEj-c2kfyqP2zvvXwopKL-wqkHRn_m5Pbyutf5hJGFG7dEohmsJqzjMQEbmCkj9kZ0Ypm0Yh-C2SaD2kuaCXQUSnq-7_W4ScNFxRPkytsNy0d4kH1xTxXcEjGVWkiqEUvZd8Nh_Yd_hhVJACqxwJ727rJaKN6x1efr30R6iHDLBXOElBiSxHAcGARZqnVDmP7Ciz_kS92OnnWCwoVs4OI9GvKdqa2mk503etvgnFS7A3NVb2DVV9Rs5Zyq3umE-2J7TP4cOEVWosAR5L6NAmJUypfy-SFFuVhLvrj_R5vpKpzzHTsECDd6Iduuj5s12QEctvV_9AOXZsnJl2hknMiJ_Cj4kFh789oR8cO8sSsmya-9SNzmP9b_Lmq5HTTt3YYJy3NF1HMtA5lzkJeWLBCPqH2dQz0emDmYYgyimJ4-GOIP7aM9L6fDHjn5H3TDln8vVc8tHx10oz11IWwd4p82yti6NZ6k9vhEcRxa0JrzUfHsW54AAkb9xyq0C4BUnASO-OQLfBLLOjD4s5lv4JRiJ5-galtlxboSjHx6Nj8VikNuQ7YZxZBLofLUeebNbDdAoEA5uxJ3BFtrNxw1dv2u3B7wyL8XWiRiwZwfibKIgRM_1T7W_8iZ1rc9_HhGFoPLf5cSU0Kn82uRJNBwzJzLjoW_L6xkUwwcUpqGwgikY3danrUblRIZTFok6J-mvXueKmCF3j6zYyPiIGR5kpPQ0x49Ii0I2jqRibmqP5_rwsl2Gc0_TC2GpGkTw29ONw_ry86Uy9x5CxdYVgaShTYDLA4uGU6rp1Qtg6dFvNfsRX_g4IeGIt1vdWbjmwL3kntCsiW-rQ-FQLoqmZxl8xBpA9ig0wrhhjGEshytQHYSFVF0RKHNqXKy9ZIQeKUe-mqJkv9kaTJBtNIywPvKBDxK34wMi3gZXjxwY0H4hyhB1g_q4W-pT-gTUMttL0kqlkV9d8oDO8dkfdD3tMsWSaumu9eGNEndVwMMwoGNghb1L9xn0QTXwnxE6AQFLFVCakftlr1cKUYO_LKXGzK7oe3UFF3pdYktTJbhznlu7rY5EuXyCkhf7iSUIl5HLGkTkqkwn3i18vmbnHehRbj_SnnJikYTKA1lpC0KyFInDjxvENIXbki2ysq1PUaASlJ_-17flDtiwTmel4xCdVZl-hktnUuBLfBrUzHJdT88Oe4dKHLv4Is7UHdywf-JXJcu1IMW0fl5Po_7w4ZYlZlmVIVh-3_jjhJjigfAnH_R7-DmebrRWdvCSz-qmipyA0M4AW-pagojq1Wf5TaioXogncZiUYUgnqaOed-IRqIc2ciwby-4ceQCsifcBsnfSWd3RcloA-Jn6zNIlWE-BertjgijF1FHaW7XjwZvjFZ5l2ZCeVclezrpOeGZm0vxPoDxBkavG2B_SG7N9iyhY1p4O_o_8H8qTYgIvF9uVY2gT0niBZ8i9D9LwxJQ593ayuweJGRTXxgGYqgfk7LnUhvJmxWvnf6GKOO7ciiWePgzhppcj8cr0xkONPJ3z9vmIHx729zr2IcLPorfE9tpadZp-T-j_nVBePOa95rqDulF1_ux0xZz17cvR_5hCCgSVmYKfLOf8IVyj7RVfJoc5xq6FqBac31LUMjL_w9EABmntqinowDRdDLB4S4VArUP7CLjPbWG2Otm4IIcIx629f-vJrnQWLWpNIB-dsITn3PHi1nchCYP48vaze9Jwyf0R2nvi0ik_cJ-W-FxXPJurOr_HAsUkv5nPiwMNjSukEceCZi8siTPvXQZ1CCZbgmxwz_Bt_bOJq0PU9ttCkRnKgjmG8a0KOpkfEKzP_C2GYS--QY4VtYHp1oGox9IRgKGf8jJTbCHG_mgNnAHGJOVkUTH1W1dfnngAUJVSq5f8dQzBtCwb7KN-gH-qUG4p2fH6ub7UyZOtFaGpBvbjqdmzRFOaVVegoDV2ckvIzqGtXuqam5bFSijbfCcH_4F6iwpIV3ZZDydJ3gXpdQQHPYEImBEZIiR1ovT1rO_LcFp_BI5kQQelfpDuovrB4A7ijGY7MCDMD6rKCoSVx8JgoHCH8YCCiW4A=="

install:
  # Install this package and the packages listed in requirements.txt.
  - pip install .
  # Install extra requirements for running tests and building docs.
  - pip install -r requirements-dev.txt

script:
  - coverage run -m pytest  # Run the tests and check for test coverage.
  - coverage report -m  # Generate test coverage report.
  - codecov  # Upload the report to codecov.
  #- flake8 --max-line-length=115  # Enforce code style (but relax line length limit a bit).
  - set -e
  - make -C docs html  # Build the documentation.
  - pip install doctr
  - doctr deploy --built-docs docs/build/html . #publish the documentation
